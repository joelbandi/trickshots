<!DOCTYPE html>
<html lang="en">

<!-- Head tag -->
<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!--Description-->
    
        <meta name="description" content="Joel Bandi&#39;s bestiary of useful tutorials and programming tricks">
    

    <!--Author-->
    
        <meta name="author" content="Joel Bandi">
    

    <!--Open Graph Title-->
    
        <meta property="og:title" content="How to Be Cool Like Generators in Javascript"/>
    

    <!--Open Graph Description-->
    
        <meta property="og:description" content="Joel Bandi&#39;s bestiary of useful tutorials and programming tricks" />
    

    <!--Open Graph Site Name-->
    <meta property="og:site_name" content="Trickshots"/>

    <!--Type page-->
    
        <meta property="og:type" content="article" />
    

    <!--Page Cover-->
    

        <meta name="twitter:card" content="summary" />
    
        <meta name="twitter:site" content="JoelBandi>" />
    

    <!-- Title -->
    
    <title>How to Be Cool Like Generators in Javascript - Trickshots</title>

    <!-- Bootstrap Core CSS -->
    <link href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" rel="stylesheet"/>

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/trickshots/css/style.css">

    <!-- Custom Fonts -->
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css">
    <link href="//fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic" rel="stylesheet" type="text/css">
    <link href="//fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" rel="stylesheet" type="text/css">

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
    <script src="//oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="//oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

    <!-- Gallery -->
    <link href="//cdnjs.cloudflare.com/ajax/libs/featherlight/1.3.5/featherlight.min.css" type="text/css" rel="stylesheet" />

    <!-- Google Analytics -->
    
    <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
                    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
                m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

        ga('create', 'UA-80509175-1', 'auto');
        ga('send', 'pageview');

    </script>



</head>


<body>

    <!-- Menu -->
    <!-- Navigation -->
<nav class="navbar navbar-default navbar-custom navbar-fixed-top">
    <div class="container-fluid">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/trickshots/">Trickshots</a>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
                
                    <li>
                        <a href="https://joelbandi.github.io/">
                            
                                Joelbandi
                            
                        </a>
                    </li>
                
                    <li>
                        <a href="/trickshots/archives">
                            
                                Archives
                            
                        </a>
                    </li>
                
                    <li>
                        <a href="https://github.com/joelbandi">
                            
                                <i class="fa fa-github fa-stack-2x"></i>
                            
                        </a>
                    </li>
                
                    <li>
                        <a href="https://linkedin.com/in/joelbandi">
                            
                                <i class="fa fa-linkedin-square fa-stack-2x"></i>
                            
                        </a>
                    </li>
                
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
    <!-- /.container -->
</nav>

    <!-- Main Content -->
    <!-- Page Header -->
<!-- Set your background image for this header in your post front-matter: cover -->

<header class="intro-header" style="background-image: url('https://images.unsplash.com/photo-1436990107126-fee768acab75?ixlib=rb-0.3.5&q=80&fm=jpg&crop=entropy&s=336aa9c5166164f6a306625bc0e1f7b4')">
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <div class="post-heading">
                    <h1>How to Be Cool Like Generators in Javascript</h1>
                    
                    <h2 class="post-subheading">
                        Pausable functions? really?
                    </h2>
                    
                    <span class="meta">
                        <!-- Date and Author -->
                        
                            Authored by Joel Bandi on
                        
                        2016-09-09
                    </span>
                </div>
            </div>
        </div>
    </div>
</header>

<!-- Post Content -->
<article>
    <div class="container">
        <div class="row">

            <!-- Tags and categories -->
           
                <div class="col-lg-4 col-lg-offset-2 col-md-5 col-md-offset-1 post-tags">
                    
                        


<a href="/trickshots/tags/Tutorials/">#Tutorials</a> <a href="/trickshots/tags/Functional-programming/">#Functional programming</a> <a href="/trickshots/tags/Javascript/">#Javascript</a> <a href="/trickshots/tags/Asynchronous/">#Asynchronous</a>


                    
                </div>
                <div class="col-lg-4 col-md-5 post-categories">
                    
                        

<a href="/trickshots/categories/Tutorials/">Tutorials</a>

                    
                </div>
            

            <!-- Gallery -->
            

            <!-- Post Main Content -->
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <p>This tutorial assumes you have knowledge of <a href="www.npmjs.com" title="Node package manager">npm</a> and <a href="https://www.youtube.com/watch?v=2d7s3spWAzo" title="FunFunFunction" target="_blank" rel="external">promises</a>.</p>
<p><strong>Question:</strong> What is a generator? what is a Co-Routine and what are they trying to solve? Do aliens exist?</p>
<p>In order to understand all the above, let’s take a step back and understand the javascript model of execution. Javascript as we all know has a single threaded and synchronous execution model.<br>What that means is that there is only one thread of execution at any given point of time and every thing gets executed sequentially.</p>
<p>Because all developers have trust issues, lets confirm this fact and test out some code here in either the browser or using node.</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><div class="line"><span class="built_in">console</span>.log(<span class="string">'bork'</span>);</div><div class="line">setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="built_in">console</span>.log(<span class="string">'meow'</span>)&#125;,<span class="number">500</span>);</div><div class="line"><span class="built_in">console</span>.log(<span class="string">'woof'</span>);</div></pre></td></tr></table></figure>
<p>We expect the output<br><figure class="highlight bash"><table><tr><td class="code"><pre><div class="line">bork <span class="comment">#wait-half-second</span></div><div class="line">meow</div><div class="line">woof</div></pre></td></tr></table></figure></p>
<p>But to our dismay we see<br><figure class="highlight bash"><table><tr><td class="code"><pre><div class="line">bork</div><div class="line">woof  <span class="comment">#wait-almost-half-second</span></div><div class="line">meow</div></pre></td></tr></table></figure></p>
<p>This is because in addition to javascript being a synchronous language it is complimented by the V8 compiler’s event loop/queue system. Everytime the system encounters a time-taking function it sticks the routine in the event queue, ready to be executed once the system is free again. This is a feature of the V8 compiler in chrome and node and not javascript itself. If we were to replace <code>console.log(&#39;woof&#39;)</code> with a <code>for</code> loop that runs for 5 secs. Do you expect the same output? <strong>ABSOLUTELY</strong>. You dont believe me? Try it yourself.</p>
<p>Your output will be<br><figure class="highlight bash"><table><tr><td class="code"><pre><div class="line">bork</div><div class="line">RandomForLoopStuff <span class="comment">#after-five-friggin-seconds</span></div><div class="line">meow</div></pre></td></tr></table></figure></p>
<p>But wait!! ‘meow’ is supposed to log out after 500 milliseconds, instead takes five seconds. Well the reason behind it is the fact that functions cannot be interrupted in javascript.<br>The system logs out ‘bork’ and pushes <code>console.log(&#39;meow&#39;)</code> to the event queue and starts rolling the <code>for</code> loop. Within half a second of the start of for loop, the ‘meow’ is ready to be logged but, the system is busy with the <code>for</code> loop and it cannot be paused and it runs to completion after which the ‘meow’ is logged out.</p>
<p>Well thats a bummer. </p>
<p>Thats exactly what generator functions try to solve. They are pausable functions. Lets take a look at a generator function.<br><figure class="highlight javascript"><table><tr><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span>* <span class="title">funky_generator</span>(<span class="params"></span>)</span>&#123;</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">1</span> ; i &lt;=<span class="number">30</span> ; i++)&#123;</div><div class="line">		<span class="keyword">if</span>(i === <span class="number">15</span>)&#123;</div><div class="line">			<span class="keyword">yield</span> <span class="string">"----function paused at 15----"</span>;</div><div class="line">			<span class="keyword">continue</span>;</div><div class="line">		&#125;</div><div class="line">		<span class="built_in">console</span>.log(i);</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>Running a generator function will give you a javascript iterator which can be run by calling its next method. Everytime it encounters a <code>yield</code> keyword, the function pauses and returns the iterator object which again contains the next function and a value field which is passed to yield keyword.</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><div class="line"><span class="keyword">var</span> iter = generator();</div><div class="line"><span class="built_in">console</span>.log(iter.next().value); <span class="comment">//----function paused at 15----</span></div><div class="line">iter.next();</div></pre></td></tr></table></figure>
<p>Lets us define simple example a simple promise function API to demonstrate a generator function</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">isTrue</span>(<span class="params">name,value</span>)</span>&#123;</div><div class="line">	<span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span>(<span class="params">resolve,reject</span>)</span>&#123;</div><div class="line">		<span class="keyword">if</span>(value === <span class="literal">true</span>)&#123;</div><div class="line">			resolve(<span class="string">`The promise named <span class="subst">$&#123;name&#125;</span> has been resolved`</span>);</div><div class="line">		&#125;<span class="keyword">else</span>&#123;</div><div class="line">			reject(<span class="string">`The promise named <span class="subst">$&#123;name&#125;</span> has been rejected`</span>);</div><div class="line">		&#125;</div><div class="line">	&#125;);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>A promise is a function which is guaranteed to run to completion <em><em>eventually</em></em> but, we just don’t know when.<br>Therefore, generator functions are also used to handle these asynchronous code in a clean, efficient and easy-to-read manner.</p>
<p>So, let’s get to it.</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span>* <span class="title">funky_generator</span>(<span class="params"></span>)</span>&#123;</div><div class="line">	<span class="keyword">var</span> one = <span class="keyword">yield</span> isTrue(<span class="string">'one'</span>,<span class="literal">true</span>);</div><div class="line">	<span class="keyword">var</span> two = <span class="keyword">yield</span> isTrue(<span class="string">'two'</span>,<span class="literal">true</span>);</div><div class="line">	<span class="built_in">console</span>.log(one);</div><div class="line">	<span class="built_in">console</span>.log(two);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>There is a special npm module called <code>co</code> which excels in handling generator functions. We can install it using <code>npm install co -g</code>.</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><div class="line"><span class="keyword">var</span> co = <span class="built_in">require</span>(<span class="string">'co'</span>);</div><div class="line">co(funky_generator);</div></pre></td></tr></table></figure>
<p>The above piece of code will log out both our promise messages once they’re resolved/rejected. The <code>co</code> library first runs the generator function we pass as an argument to it. If the running generator function encounters the <code>yield</code> keyword, it realizes that the expression to the right of the keyword evaluates asynchronously and “yields” the execution to the the function wrapping it - The <code>co</code> library. The <code>co</code> library then receives the iterator object, evaluates the expression value be it a promise,thenable or a thunk and then continues the execution by calling the next method appropriately.</p>
<p>So now Let’s try and construct our own generator function handler library. We shall call it <code>harambe</code> in honor of our dear departed ape.</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><div class="line"><span class="keyword">var</span> harambe = <span class="function"><span class="keyword">function</span>(<span class="params">generator</span>) </span>&#123;</div><div class="line">    <span class="keyword">if</span> (generator &amp;&amp; generator.constructor.name === <span class="string">'GeneratorFunction'</span>) &#123; <span class="comment">//A rudimentary type check</span></div><div class="line">        <span class="keyword">const</span> iterator = generator(); <span class="comment">//get iterator from the generator.</span></div><div class="line">		<span class="comment">//define a function called iterate that runs a single iteration until it encounter yield keyword again</span></div><div class="line">        <span class="keyword">const</span> iterate = <span class="function"><span class="keyword">function</span>(<span class="params">iteration</span>) </span>&#123; </div><div class="line">            <span class="keyword">if</span> (iteration.done) <span class="keyword">return</span> iteration.value; <span class="comment">//if no more iterations, return the current iteration value</span></div><div class="line">            <span class="keyword">const</span> promise = iteration.value; <span class="comment">//else,get the promise </span></div><div class="line">			<span class="comment">//resolve or reject it acoordingly and pass the value to the next iteration to be iterated recursively</span></div><div class="line">            <span class="keyword">return</span> promise.then(x =&gt; iterate(iterator.next(x)),x =&gt; iterate(iterator.next(x))); </div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> iterate(iterator.next()); <span class="comment">//start by running the iterator</span></div><div class="line">    &#125; <span class="keyword">else</span> &#123;</div><div class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">'Argument should be a generator function'</span>); <span class="comment">//type check fail safe</span></div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>So now let’s call it by using our very own function<br><figure class="highlight javascript"><table><tr><td class="code"><pre><div class="line">harambe(funky_generator);</div></pre></td></tr></table></figure></p>
<p>So there you have it, generators in javascript and how to use them to avoid the hassles of asynchronous programming.<br>Leave comments down below or send me an email, if you want to talk to me! Keep calm and carry on :3 </p>


                
                    <!-- Go to www.addthis.com/dashboard to customize your tools -->
                    <script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-577cc072641f3241"></script>

                    <!-- Go to www.addthis.com/dashboard to customize your tools -->
                    <div class="addthis_sharing_toolbox"></div>
                
            </div>

            <!-- Comments -->
            
                <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                    


    <hr />
    <h3>Comments:</h3>
    <div id="fb-root"></div>
    <script>
        (function(d, s, id) {
            var js, fjs = d.getElementsByTagName(s)[0];
            if (d.getElementById(id)) return;
            js = d.createElement(s); js.id = id;
            js.src = "//connect.facebook.net/en_US/all.js#xfbml=1&appId=1783038578609844";
            fjs.parentNode.insertBefore(js, fjs);
        }(document, 'script', 'facebook-jssdk'));
    </script>

    <div class="fb-comments" data-href="http://joelbandi.github.io/trickshots/post/How-to-be-cool-like-generators-in-javascript/index.html" data-num-posts="7" data-width="100%" data-colorscheme="light"></div>

                </div>
            
        </div>
    </div>
</article>

    <!-- Footer -->
    <hr />

<!-- Footer -->
<footer>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <ul class="list-inline text-center">
                    
                        <li>
                            <a href="https://twitter.com/JoelBandi" target="_blank">
                                <span class="fa-stack fa-lg">
                                    <i class="fa fa-circle fa-stack-2x"></i>
                                    <i class="fa fa-twitter fa-stack-1x fa-inverse"></i>
                                </span>
                            </a>
                        </li>
                    

                    

                    
                        <li>
                            <a href="https://github.com/joelbandi" target="_blank">
                                <span class="fa-stack fa-lg">
                                    <i class="fa fa-circle fa-stack-2x"></i>
                                    <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                                </span>
                            </a>
                        </li>
                    

                    
                        <li>
                            <a href="https://linkedin.com/in/joelbandi" target="_blank">
                                <span class="fa-stack fa-lg">
                                    <i class="fa fa-circle fa-stack-2x"></i>
                                    <i class="fa fa-linkedin fa-stack-1x fa-inverse"></i>
                                </span>
                            </a>
                        </li>
                    

                    
                        <li>
                            <a href="mailto:joelvivekbandi@gmail.com" target="_blank">
                                <span class="fa-stack fa-lg">
                                    <i class="fa fa-circle fa-stack-2x"></i>
                                    <i class="fa fa-envelope-o fa-stack-1x fa-inverse"></i>
                                </span>
                            </a>
                        </li>
                    

                    
                </ul>
                <p class="copyright text-muted">Original Theme <a target="_blank" href="http://startbootstrap.com/template-overviews/clean-blog/">Clean Blog</a> from <a href="http://startbootstrap.com/" target="_blank">Start Bootstrap</a></p>
                <p class="copyright text-muted">Adapted for <a target="_blank" href="https://hexo.io/">Hexo</a> by <a href="http://www.codeblocq.com/" target="_blank">Jonathan Klughertz</a> and modified by <a href="https://joelbandi.github.io/" target="_blank">Joel Bandi</a></p>
                <p class="copyright text-muted"><a href="https://github.com/joelbandi/trickshots">Source</a> for this blog on GitHub</p>
            </div>
        </div>
    </div>
</footer>


    <!-- After footer scripts -->
    
<!-- jQuery -->
<script src="//code.jquery.com/jquery-2.1.4.min.js"></script>

<!-- Bootstrap -->
<script src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>

<!-- Gallery -->
<script src="//cdnjs.cloudflare.com/ajax/libs/featherlight/1.3.5/featherlight.min.js" type="text/javascript" charset="utf-8"></script>

<!-- Disqus Comments -->



</body>

</html>